<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../b.png">
    <!-- <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css"> -->
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.1.2/css/all.min.css">
    <link rel="stylesheet" href="./style.css">
    <title>注册密码验证框</title>
</head>

<body>
    <div class="box">
        <div class="inputBox">
            <input type="password" id="pswrd" placeholder="密码" onkeyup="checkPassword(this.value)">
            <span id="toggleBtn"></span>
        </div>
        <div class="checkinputBox">
            <input type="password" id="pswrd" placeholder="请确认密码" onkeyup="recheckPassword(this.value)">
            <span id="toggleBtn"></span>
        </div>
        <div class="validation">
            <ul>
                <li id="lower">至少有一个小写字母</li>
                <li id="upper">至少有一个大写字母</li>
                <li id="number">至少有一个数字</li>
                <li id="special">至少有一个特殊字符</li>
                <li id="length">至少有8个字符</li>
                <li id="recheck">两次输入的密码一致</li>
            </ul>
        </div>
    </div>

    <script>
        let pswrds = document.querySelectorAll('#pswrd')
        let toggleBtns = document.querySelectorAll('#toggleBtn')

        let lowerCase = document.querySelector('#lower')
        let upperCase = document.querySelector('#upper')
        let numberCase = document.querySelector('#number')
        let specialCase = document.querySelector('#special')
        let minLength = document.querySelector('#length')
        let reCheck = document.querySelector('#recheck')
        let checkBox = document.querySelector('.validation ul')

        let pwd;
        let repwd;

        // 检查密码
        function checkPassword(data) {
            pwd = data;

            const lower = new RegExp('(?=.*[a-z])')
            const upper = new RegExp('(?=.*[A-Z])')
            const number = new RegExp('(?=.*[0-9])')
            const special = new RegExp('(?=.*[!@#\$%\^&\*])')
            const length = new RegExp('(?=.{8,})')


            // 小写字母判断
            if (lower.test(data)) {
                lowerCase.classList.add('valid')
                // let node = document.createElement('li')
                // node.id = "lower"
                // node.innerText = '至少有一个小写字母'
                // node.classList.add('valid')
                // checkBox.appendChild(node)
            } else {
                lowerCase.classList.remove('valid')
                // let node = document.createElement('li')
                // node.classList.add('valid')
                // checkBox.removeChild(checkBox.querySelector('#lower'))
            }
            if (upper.test(data)) {
                upperCase.classList.add('valid')

            } else {
                upperCase.classList.remove('valid')

            }
            if (number.test(data)) {
                numberCase.classList.add('valid')
            } else {
                numberCase.classList.remove('valid')
            }
            if (special.test(data)) {
                specialCase.classList.add('valid')
            } else {
                specialCase.classList.remove('valid')
            }
            if (length.test(data)) {
                minLength.classList.add('valid')
            } else {
                minLength.classList.remove('valid')
            }
            recheckPassword(repwd)


        }

        // 确认密码
        function recheckPassword(data) {
            repwd = data
            if (data === '') {
                reCheck.classList.remove('valid')
            } else if (pwd === data) {
                reCheck.classList.add('valid')
            } else {
                reCheck.classList.remove('valid')
            }
        }

        toggleBtns.forEach(function (dot, i) {
            dot.onclick = function () {
                if (pswrds[i].type === 'password') {
                    pswrds[i].setAttribute('type', 'text')
                    dot.classList.add('hide')
                } else {
                    pswrds[i].setAttribute('type', 'password')
                    dot.classList.remove('hide')
                }
            }
        })




    </script>
</body>

</html>